# 福师大校园生活服务 APP 功能模块映射表

## 1. 现有模块结构

根据当前项目代码结构，现有模块包括：

| 模块名称 | 英文标识 | 核心功能 | 目录位置 |
|----------|----------|----------|----------|
| 学习模块 | study | 待办清单、智能课表、成绩单、倒计时、正念冥想 | `ui/study/` |
| 生活模块 | life | 失物招领、闲置交易 | `ui/life/` |
| 导航模块 | nav | 校园地图、地点搜索、路线规划 | `ui/nav/` |
| 通知模块 | notify | 系统通知、即时消息 | `ui/notify/` |
| 个人中心 | mine | 个人资料、收藏夹、设置 | `ui/mine/` |

## 2. 扩展功能模块映射

### 2.1 短期扩展功能（1-3个月）

| 扩展功能 | 所属模块 | 子模块名称 | 理由说明 | 目录位置 |
|----------|----------|------------|----------|----------|
| 校园卡集成 | 生活模块 | campus_card | 校园卡是学生日常生活的核心服务之一，与生活服务紧密相关 | `ui/life/campus_card/` |
| 图书馆服务 | 学习模块 | library | 图书馆是学生学习的重要资源，属于学习相关功能 | `ui/study/library/` |
| 食堂菜单 | 生活模块 | canteen | 食堂就餐是学生日常生活的重要组成部分，属于生活服务 | `ui/life/canteen/` |
| 校车时刻表 | 导航模块 | shuttle_bus | 校车服务属于校园交通导航范畴，与现有导航功能互补 | `ui/nav/shuttle_bus/` |

### 2.2 中期扩展功能（3-6个月）

| 扩展功能 | 所属模块 | 子模块名称 | 理由说明 | 目录位置 |
|----------|----------|------------|----------|----------|
| 社团管理 | 生活模块 | community | 社团活动是校园生活的重要组成部分，属于生活服务范畴 | `ui/life/community/` |
| 就业服务 | 生活模块 | career | 就业服务是学生校园生活的延伸，属于生活服务范畴 | `ui/life/career/` |
| 校园活动 | 生活模块 | activities | 校园活动组织与参与是校园生活的重要内容，属于生活服务 | `ui/life/activities/` |
| 学习资源 | 学习模块 | resources | 学习资源共享与交流属于学习相关功能，与现有学习模块互补 | `ui/study/resources/` |

### 2.3 长期扩展功能（6-12个月）

| 扩展功能 | 所属模块/新建 | 模块名称 | 理由说明 | 目录位置 |
|----------|---------------|----------|----------|----------|
| AI 智能助手 | 新建独立模块 | ai_assistant | AI助手是跨模块的通用功能，需要独立模块支持 | `ui/ai/` |
| 校园物联网 | 新建独立模块 | iot | 校园物联网涉及多个领域，需要独立模块管理 | `ui/iot/` |
| 跨平台支持 | 技术实现 | - | 属于技术架构升级，不影响模块划分 | - |
| 开放平台 | 技术实现 | - | 属于技术架构升级，不影响模块划分 | - |

## 3. 模块划分原则

### 3.1 功能相关性原则
- 功能相近的模块放在同一父模块下，如校园卡、食堂、社团等都属于生活服务，放在生活模块下
- 学习相关功能如图书馆、学习资源等放在学习模块下

### 3.2 用户使用频率原则
- 高频使用的功能放在一级模块下，便于用户快速访问
- 低频使用的功能可以作为子模块，通过层级导航访问

### 3.3 代码组织原则
- 模块划分清晰，便于代码维护和扩展
- 模块间耦合度低，便于独立开发和测试
- 遵循单一职责原则，每个模块只负责一个核心功能领域

### 3.4 扩展性原则
- 模块设计考虑未来扩展，预留子模块扩展空间
- 支持动态加载和按需初始化，提高应用性能

## 4. 模块结构示意图

```
┌───────────────────────────────────────────────────────────┐
│                       UI Layer                            │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│  │  Study      │  │  Life       │  │  Nav        │        │
│  │  ├─ Todo    │  │  ├─ Lost&Found│  │  ├─ Map     │        │
│  │  ├─ Course  │  │  ├─ IdleTrade│  │  ├─ Search  │        │
│  │  ├─ Grades  │  │  ├─ CampusCard│  │  ├─ Route   │        │
│  │  ├─ Countdown│  │  ├─ Canteen  │  │  └─ ShuttleBus│     │
│  │  ├─ Mindfulness│  │  ├─ Community│  │             │     │
│  │  ├─ Library │  │  ├─ Career    │  │             │     │
│  │  └─ Resources│  │  └─ Activities│  │             │     │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │  Notify     │  │  Mine       │  │  AI Assistant│        │
│  │  ├─ System  │  │  ├─ Profile  │  │             │        │
│  │  └─ Chat    │  │  ├─ Favorites│  │             │        │
│  │             │  │  └─ Settings │  │             │        │
│  ├─────────────┤  ├─────────────┤  ├─────────────┤        │
│  │  IoT        │  │             │  │             │        │
│  └─────────────┘  └─────────────┘  └─────────────┘        │
└───────────────────────────────────────────────────────────┘
```

## 5. 模块间通信机制

### 5.1 现有通信方式
- 使用 Intent 进行 Activity 间通信
- 使用 ViewModel + LiveData 进行数据共享
- 使用 EventBus 或 LocalBroadcastManager 进行组件间通信（如果有）

### 5.2 扩展通信机制建议
- **Jetpack Navigation**：统一管理页面导航，简化模块间跳转
- **ViewModel 共享**：使用 Activity 级别的 ViewModel 实现跨 Fragment 数据共享
- **EventBus/FlowEventBus**：实现组件间解耦通信
- **依赖注入**：使用 Hilt 实现模块间依赖管理

## 6. 数据共享策略

### 6.1 跨模块数据共享
- **UserProfile**：用户信息在多个模块间共享，使用单例模式或依赖注入管理
- **Settings**：应用设置在多个模块间共享，使用 SharedPreferences 或 DataStore 存储
- **Notification**：通知数据在通知模块和其他模块间共享，使用 Room 数据库存储

### 6.2 数据一致性保障
- 使用 Room 数据库的事务机制保障数据一致性
- 使用 LiveData 实现数据变化的实时通知
- 使用 Repository Pattern 封装数据访问，确保数据来源统一

## 7. 模块扩展建议

### 7.1 模块化架构升级
- **动态功能模块**：将大型模块拆分为动态功能模块，支持按需下载和加载
- **组件化开发**：实现真正的组件化架构，每个模块可独立编译和运行
- **AAB 格式**：使用 Android App Bundle 格式，支持动态功能交付

### 7.2 代码复用机制
- **基础组件库**：抽取通用组件和工具类，形成基础组件库
- **业务组件库**：抽取通用业务逻辑，形成业务组件库
- **UI 组件库**：抽取通用 UI 组件，形成 UI 组件库

### 7.3 测试策略
- **模块内测试**：每个模块独立进行单元测试和集成测试
- **跨模块测试**：测试模块间的交互和数据共享
- **端到端测试**：测试完整的用户流程，涉及多个模块

## 8. 总结

通过合理的模块划分和映射，可以确保扩展功能与现有架构无缝集成，同时保持代码的可维护性和扩展性。模块划分应遵循功能相关性、用户使用频率、代码组织和扩展性原则，确保每个模块职责单一、耦合度低、便于独立开发和测试。

随着应用功能的不断扩展，建议逐步升级到更现代化的模块化架构，如动态功能模块、组件化开发等，以支持更大规模的应用开发和更灵活的功能扩展。